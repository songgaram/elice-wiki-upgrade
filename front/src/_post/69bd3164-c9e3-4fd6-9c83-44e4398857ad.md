# 프로젝트 대비 백엔드 실습

기술 - 대표: JS, 백엔드
날짜: 2022년 2월 26일
주차: 6

**목차**

---

# 3계층 설계 (3-Layer architecture)

## 🔻 설계

- 코드와 파일, 그리고 폴더 구조를 설계하는 것

### ◾ 설계의 중요성

- 수정할 코드를 찾아 유지보수하기 쉽다
- 코드와 코드 사이에 어떤 관계가 있는지 알아볼 수 있다
- 각 코드의 역할과 기능을 명확하게 구분하여 기능별 테스트(유닛 테스트)를 진행할 수 있다
- 각 역할별로 개발 분업이 가능해진다
    - 역할이 아닌 MVP 별로 개발 업무를 분담하는 경우에도, 각 MVP가 어떤 흐름으로 구현되는지 코드 구조를 보고 이해하기 쉬워진다.
- 새로운 기능을 추가하고자 할 때, 기존에 존재하는 코드의 어느 부분을 수정하고 새로 작성해야하는지 알기 쉽다. (확장성 확보)

## 🔻 3계층 설계

![Untitled](%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%83%E1%85%A2%E1%84%87%E1%85%B5%20%E1%84%87%E1%85%A2%E1%86%A8%E1%84%8B%E1%85%A6%E1%86%AB%E1%84%83%E1%85%B3%20%E1%84%89%E1%85%B5%E1%86%AF%E1%84%89%E1%85%B3%E1%86%B8%20a73351f9d844475bb80a75ad63fc2942/Untitled.png)

### ◾ Control layer 컨트롤러

- 사용자의 요청을 분석한 후, 알맞은 서비스로 해당 요청을 전달해 준 다음, 서비스의 결과를 다시 응답하는 층
- **라우팅**이 이루어지는 층
- express의 경우, req.params(), req.body(), res.status(), res.send() 와 같은 코드가 작성

### ◾ Service layer 서비스

- 컨트롤러로부터 전달된 요청에 **로직**을 적용하는 층
- 로직 예시


### ◾ Model layer 데이터

- **데이터** 관련 코드가 작성되는 층
- Mongoose의 경우 `Model.find({})` 등의 코드가 작성됨.

### ◾ [참고 링크](https://velog.io/@hopsprings2/%EA%B2%AC%EA%B3%A0%ED%95%9C-node.js-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%95%84%ED%82%A4%ED%85%8D%EC%B3%90-%EC%84%A4%EA%B3%84%ED%95%98%EA%B8%B0)

# 포트폴리오 웹 서비스 구현 화면

## 🔻 화면 구성

- 기본 페이지 (로그인 창)
- 회원가입 페이지
- 개인 페이지 - 프로필, 학력, 수상이력, 프로젝트, 자격증 - 학력 추가/편집/완료 , 프로필(사용자정보)편집/완료 , 수상이력,프로젝트,자격증 추가 및 편집
- 네트워크 페이지
- 다른 사용자 페이지 (편집 불가)

## 🔻 MVP

### ◾ User MVP

- 회원가입, 로그인, 사용자 목록(네트워크 페이지), 사용자 정보 조회(개인 페이지)

### ◾ Education MVP

- 학력 추가, 학력 정보 조회, 학력 정보 수정

### ◾ Award MVP

- 수상 이력 추가, 수상 정보 조회, 수상 정보 수정

### ◾ Project MVP

- 프로젝트 추가, 프로젝트 정보 조회, 프로젝트 정보 수정

### ◾ Certificate MVP

- 자격증 추가, 자격증 정보 조회, 자격증 정보 수정



# 나만의 Rest API를 어떻게 3계층 구조로 만들 수 있는가

(회원가입 API를 예시로) 

## 🔻 API 설계하기

### ◾ (1) URI 엔드포인트와 HTTP 메소드를 정하기

- 회원가입 API 이므로 `/user/register`
- HTTP 메소드는 사용자 정보를 db에 저장하는 과정이므로 post 사용

### ◾ (2) 요청 받을 json과 응답으로 보낼 데이터(json) 정하기

- 요청 - name, email, password
- 응답 - 프론트에서는 사용자가 누구인지 식별할 수 있도록 id가 필요하므로 id, name, email, description

### ◾ (3) Mongoose Schema 만들기

- 반환할 json 데이터를 바탕으로 스키마 짜기
- 회원가입 시 받을 name, email, password(hash), id 필요
- 나중에 인사말 등으로 사용되는 description 필요
- timestamp도 활용

## 🔻 3계층 구조의 코드 작성하기

<aside>
📁 작성해야 할 파일

1. routers > ##Router.js 
2. services > ##Service.js 
3. db/models > ##Model.js (혹은 ##.js) 
</aside>

### ◾ ##Router.js

- req, res 표현 사용되는 곳 , URI 엔드포인트와 HTTP 메소드 작성
- 이 라우터 층에서 사용할 서비스 층의 함수(메소드)를 정해야 함 `userAuthService` `addUser`

### ◾ ##Service.js

- class를 생성하고 static 과 async가 붙은 메소드 만들기
- 이 서비스 층에서 상ㅇ할 모델 층의 함수를 정해야 함 `User` `create`

### ◾ ##Model.js

- 모델 층에서 비로소 Mongoose Model의 쿼리 함수(create, findOne 등)가 사용됨